---
title: "Vercel"
sidebarTitle: "Vercel"
description: "End-to-end example of calling external tools with the Vercel AI SDK."
---

## Setup

```bash
npm i ai @ai-sdk/openai @nangohq/node
```

<Tip>
This example uses the Node SDK, a lightweight wrapper over Nangoâ€™s REST API. The same flow works in any language by using the [API reference](https://nango.dev/docs/reference/api/authentication).
</Tip>

**Requirements:** 
- A Nango account with a Hubspot integration configured and the `whoami` action enabled.
- An OpenAI account (or another LLM provider).

## Usage

Example of a basic tool that calls an external API (Hubspot):

```ts
import { generateText } from "ai";
import { openai } from "@ai-sdk/openai";
import { Nango } from "@nangohq/node";
import { tool } from "ai";
import { z } from "zod";

export async function runVercelAgent() {
  if (!process.env.OPENAI_API_KEY) {
    console.log("Missing environment variable: OPENAI_API_KEY.");
  }

  const nango = new Nango({ secretKey: process.env.NANGO_SECRET_KEY! });

  const userId = "user1";
  const userEmail = "user1@example.com";
  const organizationId = "org1";
  const integrationId = "hubspot";

  // Step 1: Ensure the user is authorized
  console.log("ðŸ”’ Checking API authorization...");
  const connections = await nango.listConnections({ integrationId });
  let connectionId = connections.connections.find((c) => c.tags?.end_user_id === userId)?.connection_id;

  // Step 2: If the user is not authorized, redirect to the auth flow.
  if (!connectionId) {
    const session = await nango.createConnectSession({
      allowed_integrations: [integrationId],
      tags: {
        end_user_id: userId,
        end_user_email: userEmail,
        organization_id: organizationId
      },
    });

    console.log(`Please authorize the app by visiting this URL: ${session.data.connect_link}`);

    const connection = await nango.waitForConnection(integrationId, userId);
    connectionId = connection!.connection_id;
  }

  // Step 3: Send a prompt to your model with tool definitions
  console.log("ðŸ¤– Agent running...");
  const response = await generateText({
    model: openai("gpt-4o"),
    prompt: "Using the who_am_i tool, provide the current user info.",
    tools: {
      who_am_i: tool({
        description: "Get the current user info.",
        inputSchema: z.object({}),
        execute: async () => {
          // Step 4: Execute the requested tool with Nango.
          return await nango.triggerAction(integrationId, connectionId, "whoami");
        },
      }),
    },
  });

  console.log("âœ… Agent retrieved your Hubspot user info:", response.toolResults[0].output);
}
```

<Tip>
You can let agents or models introspect available tools and their specifications by calling this [endpoint](/reference/api/scripts/config). Your model can then automatically decide which tool to call.
</Tip>
