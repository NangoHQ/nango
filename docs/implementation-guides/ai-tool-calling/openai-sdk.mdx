---
title: "OpenAI"
sidebarTitle: "OpenAI"
description: "End-to-end example of calling external tools with the OpenAI SDK."
---

## Setup

```bash
npm i openai @nangohq/node
```

<Tip>
This example uses the Node SDK, a lightweight wrapper over Nangoâ€™s REST API. The same flow works in any language by using the [API reference](https://nango.dev/docs/reference/api/authentication).
</Tip>

**Requirements:** 
- A Nango account with an Hubspot integration configured and the `whoami` action enabled.
- An OpenAI account.

## Usage

Example of a basic tool that calls an external API (Hubspot):

```ts
import OpenAI from "openai";
import { Nango } from "@nangohq/node";

export async function runOpenAIAgent() {
  const client = new OpenAI({ apiKey: process.env.OPENAI_API_KEY! });
  const nango = new Nango({ secretKey: process.env.NANGO_SECRET_KEY! });

  const userId = "user1", integrationId = "Hubspot";

  // Step 1: Ensure the user is authorized
  console.log("ðŸ”’ Checking API authorization...")
  let connectionId = (await nango.listConnections({ integrationId, userId })).connections[0]?.connection_id;

  // Step 2: If the user is not authorized, redirect to the auth flow.
  if (!connectionId) {
    const session = await nango.createConnectSession({
      allowed_integrations: [integrationId],
      end_user: { id: userId },
    }); // Handle API auth via Nango.

    console.log(`Please authorize the app by visiting this URL: ${session.data.connect_link}`);

    const connection = await nango.waitForConnection(integrationId, userId);
    connectionId = connection!.connection_id;
  }

  // Step 3: Send a prompt to your model.
  console.log("ðŸ¤– Agent running...")
  const response = await client.responses.create({
    model: "gpt-5",
    input: "Using the who_am_i tool, provide the current user info.",
    tools: [
      {
        type: "function",
        name: "who_am_i",
        description: "Get the current user info.",
        parameters: { type: "object", properties: {}, additionalProperties: false },
        strict: true,
      },
    ],
  });

  // Check if the model requested a tool call.
  const functionCall = response.output.find((item) => item.type === "function_call") as any;

  if (functionCall?.name === "who_am_i") {
    try {
      // Step 4: Execute the requested tool with Nango.
      const userInfo = await nango.triggerAction("Hubspot", connectionId, "whoami"); // Call tools via Nango.
      console.log("âœ… Agent retrieved your Hubspot user info:", userInfo);
    } catch (error: any) {
      console.error("Nango API error:", error.response?.data?.error || error);
    }
  } else {
    // Handle plain text or other model responses
    console.log(response.output_text);
  }
}
```

<Tip>
You can let agents or models introspect available tools and their specifications by calling this [endpoint](/reference/api/scripts/config). Your model can then automatically decide which tool to call.
</Tip>